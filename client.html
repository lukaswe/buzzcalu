<!doctype html>
<html>
<head>
    <title>Socket.IO chat</title>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <link href="styles/client.css" rel="stylesheet">
    <script src="/socket.io/socket.io.js"></script>

    <script>
        var currColor;
        function changeColor(colorName) {
            document.body.style.backgroundColor = colorName;
            currColor = colorName;
        }
    </script>
    <!--<script src="/jquery/dist/jquery.js" type="text/javascript"></script>-->
</head>


<script>
    var socket = io.connect();

    //Daten vom Server empfangen bzw
    //socket.on = conect listener
    socket.on('fastest player', function (player) {

        console.log("fastest player funzt: " + player);
        //BuzzerBtn ausgrauen, um ihn nur einmal drücken zu können.
        $('#buzzerBtn').prop('disabled', true);
        if (player == $('#nameField').val()) {
            $('#buzz-text').text("Glückwunsch, Du bist dran!");
            changeColor('green');
        }
        else {
            $('#buzz-text').text("Zu Langsam, " + player + " ist dran!");
            changeColor('grey');
        }
    });


    function send_buzz() {
        var socket = io();

        console.log("test4: " + $('#nameField').val());
        // Eigenes Event vom Client an den Server schicken
        socket.emit('send_buzz', $('#nameField').val());

        //  return false;
    }
    ;

    var text = ('{"name"}')
    function save_name() {
        document.getElementById("nameField").disabled = true;
        document.getElementById("savenameBtn").disabled = true;
        document.getElementById("buzz-div").style = "visibility:visible;";
        document.getElementById("name-div").style = "visibility:hidden;";

        var obj = ({"nickname": $('#nameField').val(), "pkte": 0});
        console.log("Hallo " + obj.nickname);
        socket.emit('set nickname', obj.nickname);
        // var myJSON = JSON.stringify(obj);
        $('#buzz-text').text("Sei bereit, " + obj.nickname + "!");
    }
    ;
</script>

<body>

<p id="demo"></p>
<script>//document.getElementById("savename").innerHTML = obj.name;</script>
<form action="">
    <div id="name-div">

        <h1 id="name-header">Bitte Namen eingeben</h1>

        <input id="nameField" autocomplete="off"/>
        <button type="button" id="savenameBtn" onclick="save_name()">Save Name</button>
    </div>


    <div id="buzz-div" style="visibility:hidden;">
        <h1 id="buzz-text">Be Ready ###</h1>
        <button type="button"
                onclick="send_buzz()"
                id="buzzerBtn">

            Buzz!
        </button>

    </div>
</form>
</body>
</html>
