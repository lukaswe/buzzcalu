<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <title>BuzzCaLu Overview Screen</title>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <link href="styles/overview.css" type="text/css" rel="stylesheet">
</head>

<script>

    var socket = io.connect();
    var playerArray = new Array;
    var i = 1;


    //Clients verbinden sich
    socket.on('playerList', function (nicknameObj) {
        //Array mit Spielern füllen
        playerArray.push(nicknameObj);
        console.log(nicknameObj.nickname + " just connected!");
        //Tabelle bauen
        start();
        fillNameFields();
    });

    socket.on('punkteAktualisiert', function (schnellster) {
        //Array mit Spielern füllen
        playerArray.push(schnellster);
        console.log(schnellster.nickname + " kriegt Punkte!!");
        //Tabelle bauen
        start();
    });

    socket.on('fastest player', function (player) {
        //document.getElementById("erster-text").innerHTML = player;
        $('#erster-text').text(player.nickname);
    });


    //Spieler in Tabelle eintragen
    function start() {
        var tbody = document.getElementById("ctbody");
        console.log("in start");
        renderRows(tbody);

    }
    function renderRows(tbody) {
        tbody.innerHTML = '';
        console.log("in render ROws");

        //playerArray = JSON.parse(playerArray);
        console.log("playerArray: " + playerArray);
        playerArray.forEach(function (player) {
            //neue Zelie
            console.log("player: " + player.pkte);
            var row = document.createElement("tr");

            //neue Spalten
            var playerNameTd = document.createElement("td"),
                    playerPkteTd = document.createElement("td");
            // playerXoxoTd = document.createElement("button");

            playerNameTd.appendChild(document.createTextNode(player.nickname));
            playerPkteTd.appendChild(document.createTextNode(player.pkte));

            //   playerPkteTd.appendChild(document.createTextNode(player.pkte));
            // playerXoxoTd.appendChild(document.createTextNode("Eintrag entfernen"));

            row.appendChild(playerNameTd);
            row.appendChild(playerPkteTd);
            // row.appendChild(playerXoxoTd);

            //Eintrag entfernen
            //   playerXoxoTd.onclick = function () {
            //      row.parentElement.removeChild(row);
            //entfernen(player);

            //}

            tbody.appendChild(row);


        });
    }

    //Blaue Namensfelder werden befüllt
    function fillNameFields() {
        i = 1;
        playerArray.forEach(function (player) {
            console.log("i: " + i + ", " + player.nickname);
            $('#player' + i + '-name').text(player.nickname + '    ' + player.pkte);
            console.log("i: " + i);
            document.getElementById("player" + i + "-name").style = "visibility:visible;";

            i += 1;
        });
    }


</script>


<body>

<div><h1 id="heins">Wer ist dabei?</h1></div>
<div class="col-lg-5" style="margin-left: 50px">

    <table id="playerTable" class="dataList table">
        <thead>
        <tr>
            <th style="padding-right: 60px">Name</th>
            <th style="padding-right: 80px">Punktzahl</th>
            <!--  <th style="padding-right: 25px">xoxo</th>
              <th style="padding-right: 25px"></th>-->

        </tr>
        </thead>
        <tbody id="ctbody">
        <tr>
            <td style="padding-right: 60px"></td>
            <td style="padding-right: 80px"></td>
            <!--   <td style="padding-right: 25px"></td>
               <td style="padding-right: 25px"></td>-->

        </tr>


        </tbody>

        <!-- Placeholder -->
    </table>

</div>

<div><h1 id="heins">Wer ist dran?</h1></div>


<div id="erster">
    <h3 id="erster-text"> ... </h3>
</div>
<ul class="playerNameContainer">
    <ul class="playerNameBoxes-css" id="player1-name" style="visibility:hidden;">Enjoy</ul>
    <ul class="playerNameBoxes-css" id="player2-name" style="visibility:hidden;">Enjoy</ul>
    <ul class="playerNameBoxes-css" id="player3-name" style="visibility:hidden;">Enjoy</ul>
    <ul class="playerNameBoxes-css" id="player4-name" style="visibility:hidden;">Enjoy</ul>
    <ul class="playerNameBoxes-css" id="player5-name" style="visibility:hidden;">Enjoy</ul>
</ul>
</body>
</html>
